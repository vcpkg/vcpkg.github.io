<head>
    <meta name="viewport" content="width=device-width">
    <link rel="icon" href="/assets/mark/mark.svg" />
        <link rel="icon" href="/assets/mark/favicon.png" />
        <link rel="mask-icon" href="/assets/mark/favicon-mask-icon.svg" />
    
        <!-- boostrap style sheet -->
        <link
          rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
          crossorigin="anonymous"
        />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/styles/default.min.css">
    
        <!-- our style sheet and fonts -->
        <link
          href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&family=Source+Sans+Pro:wght@400;700&display=swap"
          rel="stylesheet"
        />
        <link href="/css/common.css" rel="stylesheet" />
        <link href="/css/getting-started.css" rel="stylesheet" />
    
        <!-- bootstrap scripts -->
        <script type="text/javascript"
          src="https://js.monitor.azure.com/scripts/c/ms.analytics-web-3.min.js">
        </script>
        <script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6"></script>
        <script
          src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
          integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
          crossorigin="anonymous"
        ></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/highlight.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/languages/cmake.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/languages/powershell.min.js"></script>
    
        <!-- our scripts -->
        <script src="/dist/documentation.js"></script>
        <script src="/dist/common.js"></script>
        <script src="/dist/getting-started.js"></script>
    <script>
        $(document).ready(function () {
          handleDefaultTreeViewExpand(" > docs > maintainers > cmake-guidelines.md");
          $('#loadNavBar').load('/en/navbar.html', setScrollFocus);
          $('#loadFooter').load('/en/footer.html');
          
        });
      </script>
    
    </head>
    <div id="loadNavBar"></div>
    <div class="page">
    <nav class="left-side">
      <div class="docs-mobile-heading hidden">Table of Contents</div>
      <div class="docs-mobile-exit hidden"><img class="docs-mobile-exit-icon" src="/assets/misc/exit-docs.svg"></div>
      <div class="search-bar">
        <input
                  class="search-box"
                  id="pkg-search"
                  type="search"
                  name="search"
                  placeholder="Search"
                  autocomplete="off"
                  oninput=""
                />
        <ul class="search hidden">
        </ul>
      </div>
<ul class=docs-navigation><li class="list-can-expand"><button class="button-list-can-expand">about</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/about/faq.html"><li class="list-can-expand">Frequently Asked Questions</li></a>
<a class="doc-outline-link" href="/en/docs/about/privacy.html"><li class="list-can-expand">Vcpkg telemetry and privacy</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">examples</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/examples/installing-and-using-packages.html"><li class="list-can-expand">Installing and Using Packages Example: SQLite</li></a>
<a class="doc-outline-link" href="/en/docs/examples/manifest-mode-cmake.html"><li class="list-can-expand">Manifest Mode: CMake Example</li></a>
<a class="doc-outline-link" href="/en/docs/examples/modify-baseline-to-pin-old-boost.html"><li class="list-can-expand">Pin old Boost versions</li></a>
<a class="doc-outline-link" href="/en/docs/examples/overlay-triplets-linux-dynamic.html"><li class="list-can-expand">Overlay triplets example</li></a>
<a class="doc-outline-link" href="/en/docs/examples/packaging-github-repos.html"><li class="list-can-expand">Packaging Github Repos Example: libogg</li></a>
<a class="doc-outline-link" href="/en/docs/examples/packaging-zipfiles.html"><li class="list-can-expand">Packaging Zipfiles Example: zlib</li></a>
<a class="doc-outline-link" href="/en/docs/examples/patching.html"><li class="list-can-expand">Patching Example: Patching libpng to work for x64-uwp</li></a>
<a class="doc-outline-link" href="/en/docs/examples/versioning.getting-started.html"><li class="list-can-expand">Get Started with Versioning</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">maintainers</button></li>
<ul class="collapse standard-padding">
<li class="list-can-expand"><button class="button-list-can-expand">internal</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/maintainers/internal/vcpkg_internal_get_cmake_vars.html"><li class="list-can-expand">vcpkg_internal_get_cmake_vars</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/internal/z_vcpkg_apply_patches.html"><li class="list-can-expand">z_vcpkg_apply_patches</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/internal/z_vcpkg_forward_output_variable.html"><li class="list-can-expand">z_vcpkg_forward_output_variable</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/internal/z_vcpkg_function_arguments.html"><li class="list-can-expand">z_vcpkg_function_arguments</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/internal/z_vcpkg_prettify_command_line.html"><li class="list-can-expand">z_vcpkg_prettify_command_line</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">ports</button></li>
<ul class="collapse standard-padding">
<li class="list-can-expand"><button class="button-list-can-expand">vcpkg Cmake</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake/vcpkg_cmake_build.html"><li class="list-can-expand">vcpkg_cmake_build</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake/vcpkg_cmake_configure.html"><li class="list-can-expand">vcpkg_cmake_configure</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake/vcpkg_cmake_install.html"><li class="list-can-expand">vcpkg_cmake_install</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">vcpkg Cmake Config</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake-config/vcpkg_cmake_config_fixup.html"><li class="list-can-expand">vcpkg_cmake_config_fixup</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">vcpkg Pkgconfig Get Modules</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-pkgconfig-get-modules/x_vcpkg_pkgconfig_get_modules.html"><li class="list-can-expand">x_vcpkg_pkgconfig_get_modules</li></a>
</ul>
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake-config.html"><li class="list-can-expand">vcpkg-cmake-config</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake.html"><li class="list-can-expand">vcpkg-cmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-pkgconfig-get-modules.html"><li class="list-can-expand">vcpkg-pkgconfig-get-modules</li></a>
</ul>
<li class="list-can-expand"><span id="currentPath">CMake Guidelines</span></li>
<a class="doc-outline-link" href="/en/docs/maintainers/control-files.html"><li class="list-can-expand">CONTROL files</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/execute_process.html"><li class="list-can-expand">execute_process</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/maintainer-guide.html"><li class="list-can-expand">Maintainer Guidelines and Policies</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/manifest-files.html"><li class="list-can-expand">Manifest files - <code>vcpkg.json</code></li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/portfile-functions.html"><li class="list-can-expand">Portfile Functions</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/pr-review-checklist.html"><li class="list-can-expand">Pr Review Checklist</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/registries.html"><li class="list-can-expand">Creating Registries</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_acquire_msys.html"><li class="list-can-expand">vcpkg_acquire_msys</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_add_to_path.html"><li class="list-can-expand">vcpkg_add_to_path</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_apply_patches.html"><li class="list-can-expand">vcpkg_apply_patches</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_buildpath_length_warning.html"><li class="list-can-expand">vcpkg_buildpath_length_warning</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_cmake.html"><li class="list-can-expand">vcpkg_build_cmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_make.html"><li class="list-can-expand">vcpkg_build_make</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_msbuild.html"><li class="list-can-expand">vcpkg_build_msbuild</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_ninja.html"><li class="list-can-expand">vcpkg_build_ninja</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_nmake.html"><li class="list-can-expand">vcpkg_build_nmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_qmake.html"><li class="list-can-expand">vcpkg_build_qmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_check_features.html"><li class="list-can-expand">vcpkg_check_features</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_check_linkage.html"><li class="list-can-expand">vcpkg_check_linkage</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_clean_executables_in_bin.html"><li class="list-can-expand">vcpkg_clean_executables_in_bin</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_clean_msbuild.html"><li class="list-can-expand">vcpkg_clean_msbuild</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_common_definitions.html"><li class="list-can-expand">vcpkg_common_definitions</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_configure_cmake.html"><li class="list-can-expand">vcpkg_configure_cmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_configure_gn.html"><li class="list-can-expand">vcpkg_configure_gn</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_configure_make.html"><li class="list-can-expand">vcpkg_configure_make</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_configure_meson.html"><li class="list-can-expand">vcpkg_configure_meson</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_configure_qmake.html"><li class="list-can-expand">vcpkg_configure_qmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_copy_pdbs.html"><li class="list-can-expand">vcpkg_copy_pdbs</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_copy_tools.html"><li class="list-can-expand">vcpkg_copy_tools</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_copy_tool_dependencies.html"><li class="list-can-expand">vcpkg_copy_tool_dependencies</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_download_distfile.html"><li class="list-can-expand">vcpkg_download_distfile</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_execute_build_process.html"><li class="list-can-expand">vcpkg_execute_build_process</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_execute_in_download_mode.html"><li class="list-can-expand">vcpkg_execute_in_download_mode</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_execute_required_process.html"><li class="list-can-expand">vcpkg_execute_required_process</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_execute_required_process_repeat.html"><li class="list-can-expand">vcpkg_execute_required_process_repeat</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_extract_source_archive.html"><li class="list-can-expand">vcpkg_extract_source_archive</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_extract_source_archive_ex.html"><li class="list-can-expand">vcpkg_extract_source_archive_ex</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_fail_port_install.html"><li class="list-can-expand">vcpkg_fail_port_install</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_find_acquire_program.html"><li class="list-can-expand">vcpkg_find_acquire_program</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_find_fortran.html"><li class="list-can-expand">vcpkg_find_fortran</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_fixup_cmake_targets.html"><li class="list-can-expand">vcpkg_fixup_cmake_targets</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_fixup_pkgconfig.html"><li class="list-can-expand">vcpkg_fixup_pkgconfig</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_from_bitbucket.html"><li class="list-can-expand">vcpkg_from_bitbucket</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_from_git.html"><li class="list-can-expand">vcpkg_from_git</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_from_github.html"><li class="list-can-expand">vcpkg_from_github</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_from_gitlab.html"><li class="list-can-expand">vcpkg_from_gitlab</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_from_sourceforge.html"><li class="list-can-expand">vcpkg_from_sourceforge</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_get_program_files_platform_bitness.html"><li class="list-can-expand">vcpkg_get_program_files_platform_bitness</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_get_windows_sdk.html"><li class="list-can-expand">vcpkg_get_windows_sdk</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_cmake.html"><li class="list-can-expand">vcpkg_install_cmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_gn.html"><li class="list-can-expand">vcpkg_install_gn</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_make.html"><li class="list-can-expand">vcpkg_install_make</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_meson.html"><li class="list-can-expand">vcpkg_install_meson</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_msbuild.html"><li class="list-can-expand">vcpkg_install_msbuild</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_nmake.html"><li class="list-can-expand">vcpkg_install_nmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_qmake.html"><li class="list-can-expand">vcpkg_install_qmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_list.html"><li class="list-can-expand">vcpkg_list</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_minimum_required.html"><li class="list-can-expand">vcpkg_minimum_required</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_replace_string.html"><li class="list-can-expand">vcpkg_replace_string</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">specifications</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/specifications/binarycaching.html"><li class="list-can-expand">Binary Caching v1.1 (Jul 14, 2020)</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/export-command.html"><li class="list-can-expand">Binary Export (Apr 28, 2017)</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/feature-packages.html"><li class="list-can-expand">Proposal: Features / Feature packages (Feb 23 2017)</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/manifests.html"><li class="list-can-expand">Manifests -- <code>vcpkg.json</code></li></a>
<a class="doc-outline-link" href="/en/docs/specifications/ports-overlay.html"><li class="list-can-expand">Ports Overlay (Jun 19, 2019)</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/prefab.html"><li class="list-can-expand">Vcpkg: export Android prefab Archives (AAR files)</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/registries-2.html"><li class="list-can-expand">Registries: Take 2 (including Git Registries)</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/registries.html"><li class="list-can-expand">Package Federation: Custom Registries</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/scripts-extraction.html"><li class="list-can-expand">Scripts Tree Extraction</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/versioning.html"><li class="list-can-expand">Versioning Specification </li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">users</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/users/android.html"><li class="list-can-expand">Vcpkg and Android</li></a>
<a class="doc-outline-link" href="/en/docs/users/assetcaching.html"><li class="list-can-expand">Asset Caching</li></a>
<a class="doc-outline-link" href="/en/docs/users/binarycaching.html"><li class="list-can-expand">Binary Caching</li></a>
<a class="doc-outline-link" href="/en/docs/users/config-environment.html"><li class="list-can-expand">Environment and Configuration</li></a>
<a class="doc-outline-link" href="/en/docs/users/host-dependencies.html"><li class="list-can-expand">Host Dependencies</li></a>
<a class="doc-outline-link" href="/en/docs/users/integration.html"><li class="list-can-expand">Buildsystem Integration</li></a>
<a class="doc-outline-link" href="/en/docs/users/manifests.html"><li class="list-can-expand">Manifest Mode</li></a>
<a class="doc-outline-link" href="/en/docs/users/mingw.html"><li class="list-can-expand">Vcpkg and Mingw-w64</li></a>
<a class="doc-outline-link" href="/en/docs/users/registries.html"><li class="list-can-expand">Using Registries</li></a>
<a class="doc-outline-link" href="/en/docs/users/selecting-library-features.html"><li class="list-can-expand">Selecting library features</li></a>
<a class="doc-outline-link" href="/en/docs/users/triplets.html"><li class="list-can-expand">Triplet files</li></a>
<a class="doc-outline-link" href="/en/docs/users/versioning.implementation-details.html"><li class="list-can-expand">Versioning: Implementation details</li></a>
<a class="doc-outline-link" href="/en/docs/users/versioning.html"><li class="list-can-expand">Versioning</li></a>
</ul>
<a class="doc-outline-link" href="/en/docs/README.html"><li class="list-can-expand">Quick Start</li></a>
</ul>
</nav><main class="right-side" id="main">
<div class="docs-mobile-show"><img class="docs-mobile-show-table" src="/assets/misc/table-docs.svg">Table of Contents</div>
<h1 id="cmake-guidelines">CMake Guidelines</h1>
<p>We expect that all CMake scripts that are either:</p>
<ul>
<li>In the <code>scripts/</code> directory, or</li>
<li>In a <code>vcpkg-*</code> port</li>
</ul>
<p>should follow the guidelines laid out in this document.
Existing scripts may not follow these guidelines yet;
it is expected that we will continue to update old scripts
to fall in line with these guidelines.</p>
<p>These guidelines are intended to create stability in our scripts.
We hope that they will make both forwards and backwards compatibility easier.</p>
<h2 id="the-guidelines">The Guidelines</h2>
<ul>
<li>Except for out-parameters, we always use <code>cmake_parse_arguments()</code>
rather than function parameters or referring to <code>${ARG&lt;N&gt;}</code>.<ul>
<li>This doesn't necessarily need to be followed for "script-local helper functions"</li>
<li>In this case, positional parameters should be put in the function
declaration (rather than using <code>${ARG&lt;N&gt;}</code>),
and should be named according to local rules (i.e. <code>snake_case</code>).</li>
<li>Exception: positional parameters that are optional should be
given a name via <code>set(argument_name "${ARG&lt;N&gt;}")</code>, after checking <code>ARGC</code>.</li>
<li>Out-parameters should be the first parameter to a function. Example:</li></ul></li>
</ul>
<pre><code class="cmake language-cmake">  function(format out_var)
    cmake_parse_arguments(PARSE_ARGV 1 "arg" ...)
    # ... set(buffer "output")
    set("${out_var}" "${buffer}" PARENT_SCOPE)
  endfunction()</code></pre>
<ul>
<li>There are no unparsed or unused arguments.
Always check for <code>ARGN</code> or <code>arg_UNPARSED_ARGUMENTS</code>.
<code>FATAL_ERROR</code> when possible, <code>WARNING</code> if necessary for backwards compatibility.</li>
<li>All <code>cmake_parse_arguments</code> must use <code>PARSE_ARGV</code>.</li>
<li>All <code>foreach</code> loops must use <code>IN LISTS</code> and <code>IN ITEMS</code>.</li>
<li>The variables <code>${ARGV}</code> and <code>${ARGN}</code> are unreferenced,
except in helpful messages to the user.<ul>
<li>(i.e., <code>message(FATAL_ERROR "blah was passed extra arguments: ${ARGN}")</code>)</li></ul></li>
<li>We always use functions, not macros or top level code.<ul>
<li>Exception: "script-local helper macros". It is sometimes helpful to define a small macro.
This should be done sparingly, and functions should be preferred.</li>
<li>Exception: <code>vcpkg.cmake</code>'s <code>find_package</code>.</li></ul></li>
<li>Scripts in the scripts tree should not be expected to need observable changes
as part of normal operation.<ul>
<li>Example violation: <code>vcpkg_acquire_msys()</code> has hard-coded packages and versions that need updating over time due to the MSYS project dropping old packages.</li>
<li>Example exception: <code>vcpkg_from_sourceforge()</code> has a list of mirrors which needs maintenance but does not have an observable behavior impact on the callers.</li></ul></li>
<li>All variable expansions are in quotes <code>""</code>,
except those which are intended to be passed as multiple arguments.<ul>
<li>Example:</li></ul></li>
</ul>
<pre><code class="cmake language-cmake">  set(working_directory "")
  if(DEFINED arg_WORKING_DIRECTORY)
    set(working_directory "WORKING_DIRECTORY" "${arg_WORKING_DIRECTORY}")
  endif()
  # calls do_the_thing() if NOT DEFINED arg_WORKING_DIRECTORY,
  # else calls do_the_thing(WORKING_DIRECTORY "${arg_WORKING_DIRECTORY}")
  do_the_thing(${working_directory})</code></pre>
<ul>
<li>There are no "pointer" or "in-out" parameters
(where a user passes a variable name rather than the contents),
except for simple out-parameters.</li>
<li>Variables are not assumed to be empty.
If the variable is intended to be used locally,
it must be explicitly initialized to empty with <code>set(foo "")</code>.</li>
<li>All variables expected to be inherited from the parent scope across an API boundary (i.e. not a file-local function) should be documented. Note that all variables mentioned in triplets.md are considered documented.</li>
<li>Out parameters are only set in <code>PARENT_SCOPE</code> and are never read.
See also the helper <code>z_vcpkg_forward_output_variable()</code> to forward out parameters through a function scope.</li>
<li><code>CACHE</code> variables are used only for global variables which are shared internally among strongly coupled
functions and for internal state within a single function to avoid duplicating work.
These should be used extremely sparingly and should use the <code>Z_VCPKG_</code> prefix to avoid
colliding with any local variables that would be defined by any other code.<ul>
<li>Examples:</li>
<li><code>vcpkg_cmake_configure</code>'s <code>Z_VCPKG_CMAKE_GENERATOR</code></li>
<li><code>z_vcpkg_get_cmake_vars</code>'s <code>Z_VCPKG_GET_CMAKE_VARS_FILE</code></li></ul></li>
<li><code>include()</code>s are only allowed in <code>ports.cmake</code> or <code>vcpkg-port-config.cmake</code>.</li>
<li><code>foreach(RANGE)</code>'s arguments <em>must always be</em> natural numbers,
and <code>&lt;start&gt;</code> <em>must always be</em> less than or equal to <code>&lt;stop&gt;</code>.<ul>
<li>This must be checked by something like:</li></ul></li>
</ul>
<pre><code class="cmake language-cmake">  if(start LESS_EQUAL end)
    foreach(RANGE start end)
      ...
    endforeach()
  endif()</code></pre>
<ul>
<li>All port-based scripts must use <code>include_guard(GLOBAL)</code>
to avoid being included multiple times.</li>
<li><code>set(var)</code> should not be used. Use <code>unset(var)</code> to unset a variable,
and <code>set(var "")</code> to set it to the empty value. <em>Note: this works for use as a list and as a string</em></li>
</ul>
<h3 id="cmake-versions-to-require">CMake Versions to Require</h3>
<ul>
<li>All CMake scripts, except for <code>vcpkg.cmake</code>,
may assume the version of CMake that is present in the
<code>cmake_minimum_required</code> of <code>ports.cmake</code>.<ul>
<li>This <code>cmake_minimum_required</code> should be bumped every time a new version
of CMake is added to <code>vcpkgTools.xml</code>, as should the
<code>cmake_minimum_required</code> in all of the helper <code>CMakeLists.txt</code> files.</li></ul></li>
<li><code>vcpkg.cmake</code> must assume a version of CMake back to 3.1 in general<ul>
<li>Specific functions and options may assume a greater CMake version;
if they do, make sure to comment that function or option
with the required CMake version.</li></ul></li>
</ul>
<h3 id="changing-existing-functions">Changing Existing Functions</h3>
<ul>
<li>Never remove arguments in non-internal functions;
if they should no longer do anything, just take them as normal and warn on use.</li>
<li>Never add a new mandatory argument.</li>
</ul>
<h3 id="naming-variables">Naming Variables</h3>
<ul>
<li><p><code>cmake_parse_arguments</code>: set prefix to <code>"arg"</code></p></li>
<li><p>Local variables are named with <code>snake_case</code></p></li>
<li><p>Internal global variable names are prefixed with <code>Z_VCPKG_</code>.</p></li>
<li><p>External experimental global variable names are prefixed with <code>X_VCPKG_</code>.</p></li>
<li><p>Internal functions are prefixed with <code>z_vcpkg_</code></p>
<ul>
<li>Functions which are internal to a single function (i.e., helper functions)
are named <code>[z_]&lt;func&gt;_&lt;name&gt;</code>, where <code>&lt;func&gt;</code> is the name of the function they are
a helper to, and <code>&lt;name&gt;</code> is what the helper function does.</li>
<li><code>z_</code> should be added to the front if <code>&lt;func&gt;</code> doesn't have a <code>z_</code>,
but don't name a helper function <code>z_z_foo_bar</code>.</li></ul></li>
<li><p>Public global variables are named <code>VCPKG_</code>.</p></li>
</ul>
</main></div><div id="loadFooter"></div></html>
