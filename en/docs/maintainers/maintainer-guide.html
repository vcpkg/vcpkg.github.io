<head>
    <meta name="viewport" content="width=device-width">
    <link rel="icon" href="/assets/mark/mark.svg" />
        <link rel="icon" href="/assets/mark/favicon.png" />
        <link rel="mask-icon" href="/assets/mark/favicon-mask-icon.svg" />
    
        <!-- boostrap style sheet -->
        <link
          rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
          crossorigin="anonymous"
        />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/styles/default.min.css">
    
        <!-- our style sheet and fonts -->
        <link
          href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&family=Source+Sans+Pro:wght@400;700&display=swap"
          rel="stylesheet"
        />
        <link href="/css/common.css" rel="stylesheet" />
        <link href="/css/getting-started.css" rel="stylesheet" />
    
        <!-- bootstrap scripts -->
        <script type="text/javascript"
          src="https://js.monitor.azure.com/scripts/c/ms.analytics-web-3.min.js">
        </script>
        <script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6"></script>
        <script
          src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
          integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
          crossorigin="anonymous"
        ></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/highlight.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/languages/cmake.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/languages/powershell.min.js"></script>
    
        <!-- our scripts -->
        <script src="/dist/documentation.js"></script>
        <script src="/dist/common.js"></script>
        <script src="/dist/getting-started.js"></script>
    <script>
        $(document).ready(function () {
          handleDefaultTreeViewExpand(" > docs > maintainers > maintainer-guide.md");
          $('#loadNavBar').load('/en/navbar.html', setScrollFocus);
          $('#loadFooter').load('/en/footer.html');
          
        });
      </script>
    
    </head>
    <div id="loadNavBar"></div>
    <div class="page">
    <nav class="left-side">
      <div class="docs-mobile-heading hidden">Table of Contents</div>
      <div class="docs-mobile-exit hidden"><img class="docs-mobile-exit-icon" src="/assets/misc/exit-docs.svg"></div>
      <div class="search-bar">
        <input
                  class="search-box"
                  id="pkg-search"
                  type="search"
                  name="search"
                  placeholder="Search"
                  autocomplete="off"
                  oninput=""
                />
        <ul class="search hidden">
        </ul>
      </div>
<ul class=docs-navigation><li class="list-can-expand"><button class="button-list-can-expand">about</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/about/faq.html"><li class="list-can-expand">faq</li></a>
<a class="doc-outline-link" href="/en/docs/about/privacy.html"><li class="list-can-expand">privacy</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">examples</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/examples/installing-and-using-packages.html"><li class="list-can-expand">Installing And Using Packages</li></a>
<a class="doc-outline-link" href="/en/docs/examples/manifest-mode-cmake.html"><li class="list-can-expand">Manifest Mode Cmake</li></a>
<a class="doc-outline-link" href="/en/docs/examples/modify-baseline-to-pin-old-boost.html"><li class="list-can-expand">Modify Baseline To Pin Old Boost</li></a>
<a class="doc-outline-link" href="/en/docs/examples/overlay-triplets-linux-dynamic.html"><li class="list-can-expand">Overlay Triplets Linux Dynamic</li></a>
<a class="doc-outline-link" href="/en/docs/examples/packaging-github-repos.html"><li class="list-can-expand">Packaging Github Repos</li></a>
<a class="doc-outline-link" href="/en/docs/examples/packaging-zipfiles.html"><li class="list-can-expand">Packaging Zipfiles</li></a>
<a class="doc-outline-link" href="/en/docs/examples/patching.html"><li class="list-can-expand">patching</li></a>
<a class="doc-outline-link" href="/en/docs/examples/versioning.getting-started.html"><li class="list-can-expand">Get Started with Versioning</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">maintainers</button></li>
<ul class="collapse standard-padding">
<li class="list-can-expand"><button class="button-list-can-expand">internal</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/maintainers/internal/vcpkg_internal_get_cmake_vars.html"><li class="list-can-expand">vcpkg_internal_get_cmake_vars</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/internal/z_vcpkg_apply_patches.html"><li class="list-can-expand">z_vcpkg_apply_patches</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/internal/z_vcpkg_forward_output_variable.html"><li class="list-can-expand">z_vcpkg_forward_output_variable</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/internal/z_vcpkg_function_arguments.html"><li class="list-can-expand">z_vcpkg_function_arguments</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/internal/z_vcpkg_prettify_command_line.html"><li class="list-can-expand">z_vcpkg_prettify_command_line</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">ports</button></li>
<ul class="collapse standard-padding">
<li class="list-can-expand"><button class="button-list-can-expand">vcpkg Cmake</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake/vcpkg_cmake_build.html"><li class="list-can-expand">vcpkg_cmake_build</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake/vcpkg_cmake_configure.html"><li class="list-can-expand">vcpkg_cmake_configure</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake/vcpkg_cmake_install.html"><li class="list-can-expand">vcpkg_cmake_install</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">vcpkg Cmake Config</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake-config/vcpkg_cmake_config_fixup.html"><li class="list-can-expand">vcpkg_cmake_config_fixup</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">vcpkg Pkgconfig Get Modules</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-pkgconfig-get-modules/x_vcpkg_pkgconfig_get_modules.html"><li class="list-can-expand">x_vcpkg_pkgconfig_get_modules</li></a>
</ul>
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake-config.html"><li class="list-can-expand">vcpkg Cmake Config</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-cmake.html"><li class="list-can-expand">vcpkg Cmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/ports/vcpkg-pkgconfig-get-modules.html"><li class="list-can-expand">vcpkg Pkgconfig Get Modules</li></a>
</ul>
<a class="doc-outline-link" href="/en/docs/maintainers/cmake-guidelines.html"><li class="list-can-expand">Cmake Guidelines</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/control-files.html"><li class="list-can-expand">Control Files</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/execute_process.html"><li class="list-can-expand">execute_process</li></a>
<li class="list-can-expand"><span id="currentPath">Maintainer Guide</span></li>
<a class="doc-outline-link" href="/en/docs/maintainers/manifest-files.html"><li class="list-can-expand">Manifest Files</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/portfile-functions.html"><li class="list-can-expand">Portfile Functions</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/pr-review-checklist.html"><li class="list-can-expand">Pr Review Checklist</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/registries.html"><li class="list-can-expand">registries</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_acquire_msys.html"><li class="list-can-expand">vcpkg_acquire_msys</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_add_to_path.html"><li class="list-can-expand">vcpkg_add_to_path</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_apply_patches.html"><li class="list-can-expand">vcpkg_apply_patches</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_buildpath_length_warning.html"><li class="list-can-expand">vcpkg_buildpath_length_warning</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_cmake.html"><li class="list-can-expand">vcpkg_build_cmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_make.html"><li class="list-can-expand">vcpkg_build_make</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_msbuild.html"><li class="list-can-expand">vcpkg_build_msbuild</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_ninja.html"><li class="list-can-expand">vcpkg_build_ninja</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_nmake.html"><li class="list-can-expand">vcpkg_build_nmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_build_qmake.html"><li class="list-can-expand">vcpkg_build_qmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_check_features.html"><li class="list-can-expand">vcpkg_check_features</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_check_linkage.html"><li class="list-can-expand">vcpkg_check_linkage</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_clean_executables_in_bin.html"><li class="list-can-expand">vcpkg_clean_executables_in_bin</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_clean_msbuild.html"><li class="list-can-expand">vcpkg_clean_msbuild</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_common_definitions.html"><li class="list-can-expand">vcpkg_common_definitions</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_configure_cmake.html"><li class="list-can-expand">vcpkg_configure_cmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_configure_gn.html"><li class="list-can-expand">vcpkg_configure_gn</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_configure_make.html"><li class="list-can-expand">vcpkg_configure_make</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_configure_meson.html"><li class="list-can-expand">vcpkg_configure_meson</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_configure_qmake.html"><li class="list-can-expand">vcpkg_configure_qmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_copy_pdbs.html"><li class="list-can-expand">vcpkg_copy_pdbs</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_copy_tools.html"><li class="list-can-expand">vcpkg_copy_tools</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_copy_tool_dependencies.html"><li class="list-can-expand">vcpkg_copy_tool_dependencies</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_download_distfile.html"><li class="list-can-expand">vcpkg_download_distfile</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_execute_build_process.html"><li class="list-can-expand">vcpkg_execute_build_process</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_execute_in_download_mode.html"><li class="list-can-expand">vcpkg_execute_in_download_mode</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_execute_required_process.html"><li class="list-can-expand">vcpkg_execute_required_process</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_execute_required_process_repeat.html"><li class="list-can-expand">vcpkg_execute_required_process_repeat</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_extract_source_archive.html"><li class="list-can-expand">vcpkg_extract_source_archive</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_extract_source_archive_ex.html"><li class="list-can-expand">vcpkg_extract_source_archive_ex</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_fail_port_install.html"><li class="list-can-expand">vcpkg_fail_port_install</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_find_acquire_program.html"><li class="list-can-expand">vcpkg_find_acquire_program</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_find_fortran.html"><li class="list-can-expand">vcpkg_find_fortran</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_fixup_cmake_targets.html"><li class="list-can-expand">vcpkg_fixup_cmake_targets</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_fixup_pkgconfig.html"><li class="list-can-expand">vcpkg_fixup_pkgconfig</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_from_bitbucket.html"><li class="list-can-expand">vcpkg_from_bitbucket</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_from_git.html"><li class="list-can-expand">vcpkg_from_git</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_from_github.html"><li class="list-can-expand">vcpkg_from_github</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_from_gitlab.html"><li class="list-can-expand">vcpkg_from_gitlab</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_from_sourceforge.html"><li class="list-can-expand">vcpkg_from_sourceforge</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_get_program_files_platform_bitness.html"><li class="list-can-expand">vcpkg_get_program_files_platform_bitness</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_get_windows_sdk.html"><li class="list-can-expand">vcpkg_get_windows_sdk</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_cmake.html"><li class="list-can-expand">vcpkg_install_cmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_gn.html"><li class="list-can-expand">vcpkg_install_gn</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_make.html"><li class="list-can-expand">vcpkg_install_make</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_meson.html"><li class="list-can-expand">vcpkg_install_meson</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_msbuild.html"><li class="list-can-expand">vcpkg_install_msbuild</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_nmake.html"><li class="list-can-expand">vcpkg_install_nmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_install_qmake.html"><li class="list-can-expand">vcpkg_install_qmake</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_list.html"><li class="list-can-expand">vcpkg_list</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_minimum_required.html"><li class="list-can-expand">vcpkg_minimum_required</li></a>
<a class="doc-outline-link" href="/en/docs/maintainers/vcpkg_replace_string.html"><li class="list-can-expand">vcpkg_replace_string</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">specifications</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/specifications/binarycaching.html"><li class="list-can-expand">binarycaching</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/export-command.html"><li class="list-can-expand">Export Command</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/feature-packages.html"><li class="list-can-expand">Feature Packages</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/manifests.html"><li class="list-can-expand">manifests</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/ports-overlay.html"><li class="list-can-expand">Ports Overlay</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/prefab.html"><li class="list-can-expand">prefab</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/registries-2.html"><li class="list-can-expand">Registries 2</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/registries.html"><li class="list-can-expand">registries</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/scripts-extraction.html"><li class="list-can-expand">Scripts Extraction</li></a>
<a class="doc-outline-link" href="/en/docs/specifications/versioning.html"><li class="list-can-expand">versioning</li></a>
</ul>
<li class="list-can-expand"><button class="button-list-can-expand">users</button></li>
<ul class="collapse standard-padding">
<a class="doc-outline-link" href="/en/docs/users/android.html"><li class="list-can-expand">android</li></a>
<a class="doc-outline-link" href="/en/docs/users/assetcaching.html"><li class="list-can-expand">assetcaching</li></a>
<a class="doc-outline-link" href="/en/docs/users/binarycaching.html"><li class="list-can-expand">binarycaching</li></a>
<a class="doc-outline-link" href="/en/docs/users/config-environment.html"><li class="list-can-expand">Config Environment</li></a>
<a class="doc-outline-link" href="/en/docs/users/host-dependencies.html"><li class="list-can-expand">Host Dependencies</li></a>
<a class="doc-outline-link" href="/en/docs/users/integration.html"><li class="list-can-expand">integration</li></a>
<a class="doc-outline-link" href="/en/docs/users/manifests.html"><li class="list-can-expand">manifests</li></a>
<a class="doc-outline-link" href="/en/docs/users/mingw.html"><li class="list-can-expand">mingw</li></a>
<a class="doc-outline-link" href="/en/docs/users/registries.html"><li class="list-can-expand">registries</li></a>
<a class="doc-outline-link" href="/en/docs/users/selecting-library-features.html"><li class="list-can-expand">Selecting Library Features</li></a>
<a class="doc-outline-link" href="/en/docs/users/triplets.html"><li class="list-can-expand">triplets</li></a>
<a class="doc-outline-link" href="/en/docs/users/versioning.implementation-details.html"><li class="list-can-expand">Versioning.implementation Details</li></a>
<a class="doc-outline-link" href="/en/docs/users/versioning.html"><li class="list-can-expand">versioning</li></a>
</ul>
<a class="doc-outline-link" href="/en/docs/README.html"><li class="list-can-expand">README</li></a>
</ul>
</nav><main class="right-side" id="main">
<div class="docs-mobile-show"><img class="docs-mobile-show-table" src="/assets/misc/table-docs.svg">Table of Contents</div>
<h1 id="maintainer-guidelines-and-policies">Maintainer Guidelines and Policies</h1>
<p>This document lists a set of policies that you should apply when adding or updating a port recipe.
It is intended to serve the role of
<a href="https://www.debian.org/doc/debian-policy/">Debian's Policy Manual</a>,
<a href="https://docs.brew.sh/Maintainer-Guidelines">Homebrew's Maintainer Guidelines</a>, and
<a href="https://docs.brew.sh/Formula-Cookbook">Homebrew's Formula Cookbook</a>.</p>
<h2 id="pr-structure">PR Structure</h2>
<h3 id="make-separate-pull-requests-per-port">Make separate Pull Requests per port</h3>
<p>Whenever possible, separate changes into multiple PRs.
This makes them significantly easier to review and prevents issues with one set of changes from holding up every other change.</p>
<h3 id="avoid-trivial-changes-in-untouched-files">Avoid trivial changes in untouched files</h3>
<p>For example, avoid reformatting or renaming variables in portfiles that otherwise have no reason to be modified for the issue at hand.
However, if you need to modify the file for the primary purpose of the PR (updating the library),
then obviously beneficial changes like fixing typos are appreciated!</p>
<h3 id="check-names-against-other-repositories">Check names against other repositories</h3>
<p>A good service to check many at once is <a href="https://repology.org/">Repology</a>.
If the library you are adding could be confused with another one,
consider renaming to make it clear.</p>
<h3 id="use-github-draft-prs">Use GitHub Draft PRs</h3>
<p>GitHub Draft PRs are a great way to get CI or human feedback on work that isn't yet ready to merge.
Most new PRs should be opened as drafts and converted to normal PRs once the CI passes.</p>
<p>More information about GitHub Draft PRs:
<a href="https://github.blog/2019-02-14-introducing-draft-pull-requests/">https://github.blog/2019-02-14-introducing-draft-pull-requests/</a></p>
<h2 id="portfiles">Portfiles</h2>
<h3 id="avoid-deprecated-helper-functions">Avoid deprecated helper functions</h3>
<p>At this time, the following helpers are deprecated:</p>
<ol>
<li><code>vcpkg_extract_source_archive()</code> should be replaced by <a href="vcpkg_extract_source_archive_ex.html"><code>vcpkg_extract_source_archive_ex()</code></a></li>
<li><code>vcpkg_apply_patches()</code> should be replaced by the <code>PATCHES</code> arguments to the "extract" helpers (e.g. <a href="vcpkg_from_github.html"><code>vcpkg_from_github()</code></a>)</li>
<li><code>vcpkg_build_msbuild()</code> should be replaced by <a href="vcpkg_install_msbuild.html"><code>vcpkg_install_msbuild()</code></a></li>
<li><code>vcpkg_copy_tool_dependencies()</code> should be replaced by <a href="vcpkg_copy_tools.html"><code>vcpkg_copy_tools()</code></a></li>
</ol>
<h3 id="avoid-excessive-comments-in-portfiles">Avoid excessive comments in portfiles</h3>
<p>Ideally, portfiles should be short, simple, and as declarative as possible.
Remove any boiler plate comments introduced by the <code>create</code> command before submitting a PR.</p>
<h2 id="features">Features</h2>
<h3 id="do-not-use-features-to-implement-alternatives">Do not use features to implement alternatives</h3>
<p>Features must be treated as additive functionality. If port[featureA] installs and port[featureB] installs, then port[featureA,featureB] must install. Moreover, if a second port depends on [featureA] and a third port depends on [featureB], installing both the second and third ports should have their dependencies satisfied.</p>
<p>Libraries in this situation must choose one of the available options as expressed in vcpkg, and users who want a different setting must use overlay ports at this time.</p>
<p>Existing examples we would not accept today retained for backwards compatibility:</p>
<ul>
<li><code>libgit2</code>, <code>libzip</code>, <code>open62541</code> all have features for selecting a TLS or crypto backend. Note that <code>curl</code> has different crypto backend options but allows selecting between them at runtime, meaning the above tenet is maintained.</li>
<li><code>darknet</code> has <code>opencv2</code>, <code>opencv3</code>, features to control which version of opencv to use for its dependencies.</li>
</ul>
<h3 id="a-feature-may-engage-preview-or-beta-functionality">A feature may engage preview or beta functionality</h3>
<p>Notwithstanding the above, if there is a preview branch or similar where the preview functionality has a high probability of not disrupting the non-preview functionality (for example, no API removals), a feature is acceptable to model this setting.</p>
<p>Examples:</p>
<ul>
<li>The Azure SDKs (of the form <code>azure-Xxx</code>) have a <code>public-preview</code> feature.</li>
<li><code>imgui</code> has an <code>experimental-docking</code> feature which engages their preview docking branch which uses a merge commit attached to each of their public numbered releases.</li>
</ul>
<h3 id="default-features-should-enable-behaviors-not-apis">Default features should enable behaviors, not APIs</h3>
<p>If a consumer is depending directly upon a library, they can list out any desired features easily (<code>library[feature1,feature2]</code>). However, if a consumer <em>does not know</em> they are using a library, they cannot list out those features. If that hidden library is like <code>libarchive</code> where features are adding additional compression algorithms (and thus behaviors) to an existing generic interface, default features offer a way to ensure a reasonably functional transitive library is built even if the final consumer doesn't name it directly.</p>
<p>If the feature adds additional APIs (or executables, or library binaries) and doesn't modify the behavior of existing APIs, it should be left off by default. This is because any consumer which might want to use those APIs can easily require it via their direct reference.</p>
<p>If in doubt, do not mark a feature as default.</p>
<h3 id="do-not-use-features-to-control-alternatives-in-published-interfaces">Do not use features to control alternatives in published interfaces</h3>
<p>If a consumer of a port depends on only the core functionality of that port, with high probability they must not be broken by turning on the feature. This is even more important when the alternative is not directly controlled by the consumer, but by compiler settings like <code>/std:c++17</code> / <code>-std=c++17</code>.</p>
<p>Existing examples we would not accept today retained for backwards compatibility:</p>
<ul>
<li><code>redis-plus-plus[cxx17]</code> controls a polyfill but does not bake the setting into the installed tree.</li>
<li><code>ace[wchar]</code> changes all APIs to accept <code>const wchar_t*</code> rather than <code>const char*</code>.</li>
</ul>
<h3 id="a-feature-may-replace-polyfills-with-aliases-provided-that-replacement-is-baked-into-the-installed-tree">A feature may replace polyfills with aliases provided that replacement is baked into the installed tree</h3>
<p>Notwithstanding the above, ports may remove polyfills with a feature, as long as:</p>
<ol>
<li>Turning on the feature changes the polyfills to aliases of the polyfilled entity</li>
<li>The state of the polyfill is baked into the installed headers, such that ABI mismatch "impossible" runtime errors are unlikely</li>
<li>It is possible for a consumer of the port to write code which works in both modes, for example by using a typedef which is either polyfilled or not</li>
</ol>
<p>Example:</p>
<ul>
<li><code>abseil[cxx17]</code> changes <code>absl::string_view</code> to a replacement or <code>std::string_view</code>; the patch
<a href="https://github.com/microsoft/vcpkg/blob/981e65ce0ac1f6c86e5a5ded7824db8780173c76/ports/abseil/fix-cxx-standard.patch">https://github.com/microsoft/vcpkg/blob/981e65ce0ac1f6c86e5a5ded7824db8780173c76/ports/abseil/fix-cxx-standard.patch</a> implements the baking requirement</li>
</ul>
<h3 id="recommended-solutions">Recommended solutions</h3>
<p>If it's critical to expose the underlying alternatives, we recommend providing messages at build time to instruct the user on how to copy the port into a private overlay:</p>
<pre><code class="cmake language-cmake">set(USING_DOG 0)
message(STATUS "This version of LibContosoFrobnicate uses the Kittens backend. To use the Dog backend instead, create an overlay port of this with USING_DOG set to 1 and the `kittens` dependency replaced with `dog`.")
message(STATUS "This recipe is at ${CMAKE_CURRENT_LIST_DIR}")
message(STATUS "See the overlay ports documentation at https://github.com/microsoft/vcpkg/blob/master/docs/specifications/ports-overlay.md")</code></pre>
<h2 id="build-techniques">Build Techniques</h2>
<h3 id="do-not-use-vendored-dependencies">Do not use vendored dependencies</h3>
<p>Do not use embedded copies of libraries.
All dependencies should be split out and packaged separately so they can be updated and maintained.</p>
<h3 id="prefer-using-cmake">Prefer using CMake</h3>
<p>When multiple buildsystems are available, prefer using CMake.
Additionally, when appropriate, it can be easier and more maintainable to rewrite alternative buildsystems into CMake using <code>file(GLOB)</code> directives.</p>
<p>Examples: <a href="https://github.com/microsoft/vcpkg/blob/master/docs/maintainers/maintainer-guide.md/../../../ports/abseil/portfile.cmake">abseil</a></p>
<h3 id="choose-either-static-or-shared-binaries">Choose either static or shared binaries</h3>
<p>By default, <code>vcpkg_configure_cmake()</code> will pass in the appropriate setting for <code>BUILD_SHARED_LIBS</code>,
however for libraries that don't respect that variable, you can switch on <code>VCPKG_LIBRARY_LINKAGE</code>:</p>
<pre><code class="cmake language-cmake">string(COMPARE EQUAL "${VCPKG_LIBRARY_LINKAGE}" "static" KEYSTONE_BUILD_STATIC)
string(COMPARE EQUAL "${VCPKG_LIBRARY_LINKAGE}" "dynamic" KEYSTONE_BUILD_SHARED)

vcpkg_configure_cmake(
    SOURCE_PATH ${SOURCE_PATH}
    PREFER_NINJA
    OPTIONS
        -DKEYSTONE_BUILD_STATIC=${KEYSTONE_BUILD_STATIC}
        -DKEYSTONE_BUILD_SHARED=${KEYSTONE_BUILD_SHARED}
)</code></pre>
<h3 id="when-defining-features-explicitly-control-dependencies">When defining features, explicitly control dependencies</h3>
<p>When defining a feature that captures an optional dependency,
ensure that the dependency will not be used accidentally when the feature is not explicitly enabled.</p>
<pre><code class="cmake language-cmake">if ("zlib" IN_LIST FEATURES)
  set(CMAKE_DISABLE_FIND_PACKAGE_ZLIB OFF)
else()
  set(CMAKE_DISABLE_FIND_PACKAGE_ZLIB ON)
endif()

vcpkg_configure_cmake(
  SOURCE_PATH ${SOURCE_PATH}
  PREFER_NINJA
  OPTIONS
    -CMAKE_DISABLE_FIND_PACKAGE_ZLIB=${CMAKE_DISABLE_FIND_PACKAGE_ZLIB}
)</code></pre>
<p>The snippet below using <code>vcpkg_check_features()</code> is equivalent,  <a href="vcpkg_check_features.html">see the documentation</a>.</p>
<pre><code class="cmake language-cmake">vcpkg_check_features(OUT_FEATURE_OPTIONS FEATURE_OPTIONS
  INVERTED_FEATURES
    "zlib"    CMAKE_DISABLE_FIND_PACKAGE_ZLIB
)

vcpkg_configure_cmake(
    SOURCE_PATH ${SOURCE_PATH}
    PREFER_NINJA
    OPTIONS
      ${FEATURE_OPTIONS}
)</code></pre>
<p>Note that <code>ZLIB</code> in the above is case-sensitive. See the <a href="https://cmake.org/cmake/help/v3.15/variable/CMAKE_DISABLE_FIND_PACKAGE_PackageName.html">cmake documentation</a> for more details.</p>
<h3 id="place-conflicting-libs-in-a-manual-link-directory">Place conflicting libs in a <code>manual-link</code> directory</h3>
<p>A lib is considered conflicting if it does any of the following:</p>
<ul>
<li>Define <code>main</code></li>
<li>Define malloc</li>
<li>Define symbols that are also declared in other libraries</li>
</ul>
<p>Conflicting libs are typically by design and not considered a defect.  Because some build systems link against everything in the lib directory, these should be moved into a subdirectory named <code>manual-link</code>.</p>
<h2 id="manifests-and-control-files">Manifests and CONTROL files</h2>
<p>When adding a new port, use the new manifest syntax for defining a port;
you may also change over to manifests when modifying an existing port.
You may do so easily by running the <code>vcpkg format-manifest</code> command, which will convert existing CONTROL
files into manifest files. Do not convert CONTROL files that have not been modified.</p>
<h2 id="versioning">Versioning</h2>
<h3 id="follow-common-conventions-for-the-version-field">Follow common conventions for the <code>"version"</code> field</h3>
<p>See our <a href="../users/versioning.html#version-schemes">versioning documentation</a> for a full explanation of our conventions.</p>
<h3 id="update-the-port-version-field-in-the-manifest-file-of-any-modified-ports">Update the <code>"port-version"</code> field in the manifest file of any modified ports</h3>
<p>vcpkg uses this field to determine whether a given port is out-of-date and should be changed whenever the port's behavior changes.</p>
<p>Our convention is to use the <code>"port-version"</code> field for changes to the port that don't change the upstream version, and to reset the <code>"port-version"</code> back to zero when an update to the upstream version is made.</p>
<p>For Example:</p>
<ul>
<li>Zlib's package version is currently <code>1.2.1</code>, with no explicit <code>"port-version"</code> (equivalent to a <code>"port-version"</code> of <code>0</code>).</li>
<li>You've discovered that the wrong copyright file has been deployed, and fixed that in the portfile.</li>
<li>You should update the <code>"port-version"</code> field in the manifest file to <code>1</code>.</li>
</ul>
<p>See our <a href="manifest-files.html#port-version">manifest files document</a> for a full explanation of our conventions.</p>
<h3 id="update-the-version-files-in-versions-of-any-modified-ports">Update the version files in <code>versions/</code> of any modified ports</h3>
<p>vcpkg uses a set of metadata files to power its versioning feature.
These files are located in the following locations:</p>
<ul>
<li><code>${VCPKG_ROOT}/versions/baseline.json</code>, (this file is common to all ports) and</li>
<li><code>${VCPKG_ROOT}/versions/${first-letter-of-portname}-/${portname}.json</code> (one per port).</li>
</ul>
<p>For example, for <code>zlib</code> the relevant files are:</p>
<ul>
<li><code>${VCPKG_ROOT}/versions/baseline.json</code></li>
<li><code>${VCPKG_ROOT}/versions/z-/zlib.json</code></li>
</ul>
<p>We expect that each time you update a port, you also update its version files.</p>
<p><strong>The recommended method to update these files is to run the <code>x-add-version</code> command, e.g.:</strong></p>
<pre><code>vcpkg x-add-version zlib</code></pre>
<p>If you're updating multiple ports at the same time, instead you can run:</p>
<pre><code>vcpkg x-add-version --all</code></pre>
<p>To update the files for all modified ports at once.</p>
<p><em>NOTE: These commands require you to have committed your changes to the ports before running them. The reason is that the Git SHA of the port directory is required in these version files. But don't worry, the <code>x-add-version</code> command will warn you if you have local changes that haven't been committed.</em></p>
<p>See our <a href="../specifications/versioning.html">versioning specification</a> and <a href="../specifications/registries-2.html">registries specification</a> to learn how vcpkg interacts with these files.</p>
<h2 id="patching">Patching</h2>
<h3 id="prefer-options-over-patching">Prefer options over patching</h3>
<p>It is preferable to set options in a call to <code>vcpkg_configure_xyz()</code> over patching the settings directly.</p>
<p>Common options that allow avoiding patching:</p>
<ol>
<li>[MSBUILD] <code>&lt;PropertyGroup&gt;</code> settings inside the project file can be overridden via <code>/p:</code> parameters</li>
<li>[CMAKE] Calls to <code>find_package(XYz)</code> in CMake scripts can be disabled via <a href="https://cmake.org/cmake/help/v3.15/variable/CMAKE_DISABLE_FIND_PACKAGE_PackageName.html"><code>-DCMAKE_DISABLE_FIND_PACKAGE_XYz=ON</code></a></li>
<li>[CMAKE] Cache variables (declared as <code>set(VAR "value" CACHE STRING "Documentation")</code> or <code>option(VAR "Documentation" "Default Value")</code>) can be overridden by just passing them in on the command line as <code>-DVAR:STRING=Foo</code>. One notable exception is if the <code>FORCE</code> parameter is passed to <code>set()</code>. See also the <a href="https://cmake.org/cmake/help/v3.15/command/set.html">CMake <code>set</code> documentation</a></li>
</ol>
<h3 id="prefer-patching-over-overriding-vcpkg_variable-values">Prefer patching over overriding <code>VCPKG_&lt;VARIABLE&gt;</code> values</h3>
<p>Some variables prefixed with <code>VCPKG_&lt;VARIABLE&gt;</code> have an equivalent <code>CMAKE_&lt;VARIABLE&gt;</code>.
However, not all of them are passed to the internal package build <a href="https://github.com/microsoft/vcpkg/blob/master/docs/maintainers/maintainer-guide.md/../../../scripts/toolchains/windows.cmake">(see implementation: Windows toolchain)</a>.</p>
<p>Consider the following example:</p>
<pre><code class="cmake language-cmake">set(VCPKG_C_FLAGS "-O2 ${VCPKG_C_FLAGS}")
set(VCPKG_CXX_FLAGS "-O2 ${VCPKG_CXX_FLAGS}")</code></pre>
<p>Using <code>vcpkg</code>'s built-in toolchains this works, because the value of <code>VCPKG_&lt;LANG&gt;_FLAGS</code> is forwarded to the appropriate <code>CMAKE_LANG_FLAGS</code> variable. But, a custom toolchain that is not aware of <code>vcpkg</code>'s variables will not forward them.</p>
<p>Because of this, it is preferable to patch the buildsystem directly when setting <code>CMAKE_&lt;LANG&gt;_FLAGS</code>.</p>
<h3 id="minimize-patches">Minimize patches</h3>
<p>When making changes to a library, strive to minimize the final diff. This means you should <em>not</em> reformat the upstream source code when making changes that affect a region. Also, when disabling a conditional, it is better to add a <code>AND FALSE</code> or <code>&amp;&amp; 0</code> to the condition than to delete every line of the conditional.</p>
<p>This helps to keep the size of the vcpkg repository down as well as improves the likelihood that the patch will apply to future code versions.</p>
<h3 id="do-not-implement-features-in-patches">Do not implement features in patches</h3>
<p>The purpose of patching in vcpkg is to enable compatibility with compilers, libraries, and platforms. It is not to implement new features in lieu of following proper Open Source procedure (submitting an Issue/PR/etc).</p>
<h2 id="do-not-build-testsdocsexamples-by-default">Do not build tests/docs/examples by default</h2>
<p>When submitting a new port, check for any options like <code>BUILD_TESTS</code> or <code>WITH_TESTS</code> or <code>POCO_ENABLE_SAMPLES</code> and ensure the additional binaries are disabled. This minimizes build times and dependencies for the average user.</p>
<p>Optionally, you can add a <code>test</code> feature which enables building the tests, however this should not be in the <code>Default-Features</code> list.</p>
<h2 id="enable-existing-users-of-the-library-to-switch-to-vcpkg">Enable existing users of the library to switch to vcpkg</h2>
<h3 id="do-not-add-cmake_windows_export_all_symbols">Do not add <code>CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS</code></h3>
<p>Unless the author of the library is already using it, we should not use this CMake functionality because it interacts poorly with C++ templates and breaks certain compiler features. Libraries that don't provide a .def file and do not use __declspec() declarations simply do not support shared builds for Windows and should be marked as such with <code>vcpkg_check_linkage(ONLY_STATIC_LIBRARY)</code>.</p>
<h3 id="do-not-rename-binaries-outside-the-names-given-by-upstream">Do not rename binaries outside the names given by upstream</h3>
<p>This means that if the upstream library has different names in release and debug (libx versus libxd), then the debug library should not be renamed to <code>libx</code>. Vice versa, if the upstream library has the same name in release and debug, we should not introduce a new name.</p>
<p>Important caveat:</p>
<ul>
<li>Static and shared variants often should be renamed to a common scheme. This enables consumers to use a common name and be ignorant of the downstream linkage. This is safe because we only make one at a time available.</li>
</ul>
<p>Note that if a library generates CMake integration files (<code>foo-config.cmake</code>), renaming must be done through patching the CMake build itself instead of simply calling <code>file(RENAME)</code> on the output archives/LIBs.</p>
<p>Finally, DLL files on Windows should never be renamed post-build because it breaks the generated LIBs.</p>
<h2 id="code-format">Code format</h2>
<h3 id="vcpkg-internal-code">vcpkg internal code</h3>
<p>We require the C++ code inside vcpkg to follow the clang-format, if you change them. Please perform the following steps after modification:</p>
<ul>
<li>Use Visual Studio:</li>
</ul>
<ol>
<li>Configure your <a href="https://devblogs.microsoft.com/cppblog/clangformat-support-in-visual-studio-2017-15-7-preview-1/">clang-format tools</a>.</li>
<li>Open the modified file.</li>
<li>Use shortcut keys Ctrl+K, Ctrl+D to format the current file.</li>
</ol>
<ul>
<li>Use tools:</li>
</ul>
<ol>
<li>Install <a href="https://releases.llvm.org/download.html#10.0.0">llvm clang-format</a></li>
<li>Run command:</li>
</ol>
<pre><code class="cmd language-cmd">&gt; LLVM_PATH/bin/clang-format.exe -style=file -i changed_file.cpp</code></pre>
<h3 id="manifests">Manifests</h3>
<p>We require that the manifest file be formatted. Use the following command to format all manifest files:</p>
<pre><code class="cmd language-cmd">&gt; vcpkg format-manifest --all</code></pre>
<h2 id="useful-implementation-notes">Useful implementation notes</h2>
<h3 id="portfiles-are-run-in-script-mode">Portfiles are run in Script Mode</h3>
<p>While <code>portfile.cmake</code>'s and <code>CMakeLists.txt</code>'s share a common syntax and core CMake language constructs, portfiles run in "Script Mode", whereas <code>CMakeLists.txt</code> files run in "Build Mode" (unofficial term). The most important difference between these two modes is that "Script Mode" does not have a concept of "Target" -- any behaviors that depend on the "target" machine (<code>CMAKE_CXX_COMPILER</code>, <code>CMAKE_EXECUTABLE_SUFFIX</code>, <code>CMAKE_SYSTEM_NAME</code>, etc) will not be correct.</p>
<p>Portfiles have direct access to variables set in the triplet file, but <code>CMakeLists.txt</code>s do not (though there is often a translation that happens -- <code>VCPKG_LIBRARY_LINKAGE</code> versus <code>BUILD_SHARED_LIBS</code>).</p>
<p>Portfiles and CMake builds invoked by portfiles are run in different processes. Conceptually:</p>
<pre><code class="no-highlight language-no-highlight">+----------------------------+       +------------------------------------+
| CMake.exe                  |       | CMake.exe                          |
+----------------------------+       +------------------------------------+
| Triplet file               | ====&gt; | Toolchain file                     |
| (x64-windows.cmake)        |       | (scripts/buildsystems/vcpkg.cmake) |
+----------------------------+       +------------------------------------+
| Portfile                   | ====&gt; | CMakeLists.txt                     |
| (ports/foo/portfile.cmake) |       | (buildtrees/../CMakeLists.txt)     |
+----------------------------+       +------------------------------------+</code></pre>
<p>To determine the host in a portfile, the standard CMake variables are fine (<code>CMAKE_HOST_WIN32</code>).</p>
<p>To determine the target in a portfile, the vcpkg triplet variables should be used (<code>VCPKG_CMAKE_SYSTEM_NAME</code>).</p>
<p>See also our <a href="../users/triplets.html">triplet documentation</a> for a full enumeration of possible settings.</p>
</main></div><div id="loadFooter"></div></html>
