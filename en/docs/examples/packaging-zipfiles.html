<head>
    <meta name="viewport" content="width=device-width">
    <link rel="icon" href="/assets/mark/mark.svg" />
        <link rel="icon" href="/assets/mark/favicon.png" />
        <link rel="mask-icon" href="/assets/mark/favicon-mask-icon.svg" />
    
        <!-- boostrap style sheet -->
        <link
          rel="stylesheet"
          href="https://ajax.aspnetcdn.com/ajax/bootstrap/4.5.0/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
          crossorigin="anonymous"
        />
        <link
          rel="stylesheet"
          href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/styles/default.min.css"
          integrity="sha384-s4RLYRjGGbVqKOyMGGwfxUTMOO6D7r2eom7hWZQ6BjK2Df4ZyfzLXEkonSm0KLIQ"
          crossorigin="anonymous"
        />
    
        <!-- our style sheet and fonts -->
        <link href="/css/common.css" rel="stylesheet" />
        <link href="/css/getting-started.css" rel="stylesheet" />
    
        <!-- bootstrap scripts -->
        <script type="text/javascript"
          src="https://js.monitor.azure.com/scripts/c/ms.analytics-web-3.min.js">
        </script>
        <script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.6.0.min.js"></script>
        <script
          src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6"
          integrity="sha384-UBGmRyNtwBeGap4zdtKXLwUHdLJM9M/aSMLo8NaIzCxnLxYU6F9+V8veOXP3Fakh"
          crossorigin="anonymous"
        ></script>
        <script
          src="https://ajax.aspnetcdn.com/ajax/bootstrap/4.5.0/bootstrap.min.js"
          integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
          crossorigin="anonymous"
        ></script>
        <script
          src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/highlight.min.js"
          integrity="sha384-DmE/PJ3PvpXS92Z4Sn7vSRTqJd0T/2xkGtNgm2JaZFczBOZdCf3XbZOwnRHDgjAA"
          crossorigin="anonymous"
        ></script>
        <script
          src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/languages/cmake.min.js"
          integrity="sha384-x//ggWQQKDYM6gkxzOdTUJNX9tNhjYBuM1SkQ3kgwzlFH9cxNW2meFXccjs06ubh"
          crossorigin="anonymous"
        ></script>
        <script
          src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.1/build/languages/powershell.min.js"
          integrity="sha384-+05Cp42tk0QutdpySQ0HsmEskItQQcyh04nmNheHuy1epFAdvUC9kpiwJk9lx419"
          crossorigin="anonymous"
        ></script>
    
        <!-- our scripts -->
        <script src="/dist/common.js"></script>
        <script src="/dist/documentation.js"></script>
    <script>
        $(function () {
          $('#loadFooter').load('/en/footer.html');
        });
      </script>
    </head>
    <div id="loadNavBar"></div>
    <div id="banner"></div>
    <div class="page">
    <nav class="left-side">
      <div class="docs-mobile-heading hidden">Table of Contents</div>
      <div class="docs-mobile-exit hidden"><img class="docs-mobile-exit-icon" src="/assets/misc/exit-docs.svg"></div>
      <div class="search-bar">
        <input
                  class="search-box"
                  id="pkg-search"
                  type="search"
                  name="search"
                  placeholder="Search"
                  autocomplete="off"
                  oninput=""
                />
        <ul class="search hidden">
        </ul>
      </div>
      <div id="docsNavPane"></div>
      <script>
        $('#loadNavBar').load('/en/navbar.html', setScrollFocus);
        $('#docsNavPane').load('/en/docs/navpane.html', function () {
          $(function () {
            initDocumentation();
          });
        });
      </script>
</nav><main class="right-side" id="main">
<div class="docs-mobile-show"><img class="docs-mobile-show-table" src="/assets/misc/table-docs.svg">Table of Contents</div>
<h2 id="packaging-zip-files-example-zlib">Packaging <code>.zip</code> Files Example: zlib</h2>
<h3 id="bootstrap-with-create">Bootstrap with <code>create</code></h3>
<p>First, locate a globally accessible archive of the library's sources. Zip, gzip, and bzip are all supported. Strongly prefer official sources or mirrors over unofficial mirrors.</p>
<p><em>Looking at zlib's website, the URL <a href="http://zlib.net/zlib-1.2.11.tar.gz">http://zlib.net/zlib-1.2.11.tar.gz</a> looks appropriate.</em></p>
<p>Second, determine a suitable package name. This should be ASCII, lowercase, and recognizable to someone who knows the library's "human name". If the library is already packaged in another package manager, prefer that name.</p>
<p><em>Since zlib is already packaged as zlib, we will use the name zlib2 for this example.</em></p>
<p>Finally, if the server's name for the archive is not very descriptive (such as downloading a zipped commit or branch from GitHub), choose a nice archive name of the form <code>&lt;packagename&gt;-&lt;version&gt;.zip</code>.</p>
<p><em><code>zlib1211.zip</code> is a fine name, so no change needed.</em></p>
<p>All this information can then be passed into the <code>create</code> command, which will download the sources and bootstrap the packaging process inside <code>ports/&lt;packagename&gt;</code>.</p>
<pre><code class="no-highlight language-no-highlight">PS D:\src\vcpkg&gt; .\vcpkg create zlib2 http://zlib.net/zlib-1.2.11.tar.gz zlib1211.tar.gz
-- Generated portfile: D:/src/vcpkg/ports/zlib2/portfile.cmake</code></pre>
<h3 id="create-the-manifest-file">Create the manifest file</h3>
<p>In addition to the generated <code>ports/&lt;package&gt;/portfile.cmake</code>, we also need a <code>ports/&lt;package&gt;/vcpkg.json</code> file. This file is a simple set of fields describing the package's metadata.</p>
<p><em>For zlib2, we'll create the file <code>ports/zlib2/vcpkg.json</code> with the following contents:</em></p>
<pre><code class="json language-json">{
  "name": "zlib2",
  "version-string": "1.2.11",
  "description": "A Massively Spiffy Yet Delicately Unobtrusive Compression Library"
}</code></pre>
<h3 id="tweak-the-generated-portfile">Tweak the generated portfile</h3>
<p>The generated <code>portfile.cmake</code> will need some editing to correctly package most libraries in the wild, however we can start by trying out the build.</p>
<pre><code class="no-highlight language-no-highlight">PS D:\src\vcpkg&gt; .\vcpkg install zlib2
Computing installation plan...
The following packages will be built and installed:
    zlib2[core]:x64-uwp
Starting package 1/1: zlib2:x64-uwp
Building package zlib2[core]:x64-uwp...
-- Using cached C:/src/vcpkg/downloads/zlib1211.tar.gz
-- Cleaning sources at C:/src/vcpkg/buildtrees/zlib2/src/1.2.11-deec42f53b.clean. Pass --editable to vcpkg to reuse sources.
-- Extracting source C:/src/vcpkg/downloads/zlib1211.tar.gz
-- Applying patch cmake_dont_build_more_than_needed.patch
-- Using source at C:/src/vcpkg/buildtrees/zlib2/src/1.2.11-deec42f53b.clean
-- Configuring x64-uwp
-- Building x64-uwp-dbg
-- Building x64-uwp-rel
-- Installing: C:/src/vcpkg/packages/zlib2_x64-uwp/share/zlib2/copyright
-- Performing post-build validation
Include files should not be duplicated into the /debug/include directory. If this cannot be disabled in the project cmake, use
    file(REMOVE_RECURSE ${CURRENT_PACKAGES_DIR}/debug/include)
/debug/share should not exist. Please reorganize any important files, then use
    file(REMOVE_RECURSE ${CURRENT_PACKAGES_DIR}/debug/share)
The software license must be available at ${CURRENT_PACKAGES_DIR}/share/zlib2/copyright
Found 3 error(s). Please correct the portfile:
    D:\src\vcpkg\ports\zlib2\portfile.cmake</code></pre>
<p>At this point, it is a matter of reading the error messages and log files while steadily improving the quality of the portfile. Zlib required providing a discrete copy of the LICENSE to copy into the package, suppressing the build and installation of executables and headers, and removing the static libraries after they were installed.</p>
<h3 id="suggested-example-portfiles">Suggested example portfiles</h3>
<p>In the <code>ports/</code> directory are many libraries that can be used as examples, including many that are not based on CMake.</p>
<ul>
<li>Header only libraries<ul>
<li>rapidjson</li>
<li>range-v3</li></ul></li>
<li>MSBuild-based<ul>
<li>mpg123</li></ul></li>
<li>Non-CMake, custom buildsystem<ul>
<li>openssl</li>
<li>ffmpeg</li></ul></li>
</ul>
</main></div><div id="loadFooter"></div></html>
